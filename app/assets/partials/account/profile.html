<div tabindex="-1" class="screen-content" ng-controller="AccountCtrl">
  



  <aside ng-include="'/partials/account/cover.html'" 
         class="cover cover-home img-loaded" 
         ng-class="{'session':user.isAuthenticated()}">
  </aside>


   <section class="wrapper" tabindex="-1">
      <div class="wrapper-inner">



      <!--                               -->
      <!-- NAVIGATION -->
      <!--                               -->                          
      <div  class="bucket post-bucket homepage-posts" ng-include="'/partials/account/navigation.html'"></div>


      <!-- SHOPS                         
        <div class="form-background well white">
          <h5 class="article-group-title " >Vos boutiques 
              <a ng-href="/account/shop" class="pull-right small link">Ouvrir une boutique</a></h5>

            <ul ng-repeat="shop in user.shops" class="-unstyled " ng-show="user.shops.length" >
              <li class="block col-md-12">              
                <p class="-well-small">
                  <i class="icon-fire"></i>
                  <a href="/shop/{{shop.urlpath}}">{{shop.name}}</a><span ng-hide="shop.status == true" class="help-inline"><i class="icon-ok"></i>&nbsp;</span>
                  <span ng-bind-html-unsafe="shop.description"></span><i ng-show="shop.status==true" class="icon-ok green"></i>
                </p>
                
              </li>
            </ul>      
          </div>

      <!--                               -->
      <!-- CONTENT                       -->
      <!--                               -->                          


      <form name="form" novalidate="novalidate" class="form-horizontal ">
        <div class="form-background well white">
          <h5 class="article-group-title " >
            Vos données personnelles
          </h5>          


          <!-- NAME FIRSTNAME -->        
          <div class="form-group required">
            <label class="col-sm-2 control-label">Prénom</label>
            <div class="col-sm-10 ">
                <input required ng-model="user.name.givenName" placeholder="Prénom" type="text" name="firstname" class="form-control input-lg"/>
            </div>                
          </div>
          <div class="form-group required">
            <label class="col-sm-2 control-label">Nom</label>
            <div class="col-sm-10 ">
                <input required ng-model="user.name.familyName" placeholder="Nom" type="text" name="lastname" class="form-control input-lg"/>
            </div>                
          </div>
          
          <!-- PHONES --> 
          <div class="form-group required">
            <label class="col-sm-2 control-label">Téléphone</label>
            <div class="col-sm-10">
              <div ng-repeat="phone in user.phoneNumbers" class="row nomargin">
                <div class="col-xs-4 nopadding">
                  <input type="text"  ng-model="user.phoneNumbers[$index].what" placeholder="mobile" 
                  class="form-control input-lg ">
                </div>
                <div class="col-xs-6 nopadding">
                  <input type="text"  ng-model="user.phoneNumbers[$index].number" placeholder="078 000 55 55" 
                  class="form-control input-lg">
                </div>
                <div class="col-xs-1 nopadding">                
                  <a class="btn btn-default btn-lg" href ng-click="user.phoneNumbers.splice($index, 1)"><i class="icon-remove"></i></a>
                </div>

              </div>
              <hr ng-show="user.phoneNumbers.length"/>

              <div class="">
                  <a ng-click="user.phoneNumbers.push({})" ng-class="!user.phoneNumbers.length? 'btn-lg':'btn-xs'"
                     class="btn btn-info  btn-block"> Ajouter un téléphone</a>
              </div>
            </div>
          </div>
                 

          <!-- EMAIL & VALIDATION -->   
          <div class="col-xs-12  ">
            <div class="alert alert-warning" ng-cloak ng-show="user.email.status !== true" >
                Vous devez valider votre addresse email.
            </div>
          </div>

          <div class="form-group required">
            <label class="col-sm-2 control-label">Email</label>
            <div class="col-sm-offset-2 row ">
              <div class="col-xs-9">                
                <input id="email" required ng-model="user.email.address" type="email" name="email" class="form-control input-lg"/><span ng-hide="form.email.$invalid || EmailError" class="accout-field-valid"><i ng-show="user.email.status == true" class="icon-ok green"></i>
                </span>

              </div>              
              <div class="col-xs-1">                
                <input type="submit" ng-hide="user.email.status == true" ng-click="verify(user)" value="Valider" ng-disabled="form.$invalid||WaitText" class="btn btn-lg btn-danger"/>
              </div>              
              
            </div>
          </div>
        </div>
          <!-- ADDRESS -->

          <!-- ADDRESSES -->
        <div class="alert alert-warning" ng-hide="user.addresses.length">
          <strong>Votre profile est incomplet!</strong> 
          Pour passer une commande, vous devez indiquer au moins une adresse de livraison.
        </div>

        <div class="nomargin  white" ng-class="{'primary-content':user.addresses[$index].primary}" ng-repeat="address in user.addresses" >
              <a href ng-click="user.addresses.splice($index, 1)" 
              class="pull-right btn btn-small btn-inverse"><i class="icon-remove"></i> </a>


            <h5 class="article-group-title black" >
                Adresse N°{{$index}}# {{user.addresses[$index].name}} 
            </h5>          
            <div class="form-background">

            <!-- NOM -->
            <div class="form-group required">                  
              <label class="col-sm-2 control-label">Nom complet</label>
              <div class="col-sm-10">
                  <input id="full-name"  ng-model="user.addresses[$index].name" type="text" placeholder="Nom et prénom"
                  class="form-control input-lg" require>
                  <p class="help-block"></p>
                  
              </div>
            </div>

            <!-- NOTE -->
            <div class="form-group  required">
              <label class="col-sm-2 control-label">Note au livreur</label>
              <div class="col-sm-10">
                  <input id="full-name"  ng-model="user.addresses[$index].note" type="text" placeholder="Note au livreur, code,..."
                  class="form-control input-lg" require>
              </div>
            </div>

            <!-- RUE/N°/ETAGE -->
            <div class="form-group  required">
              <label class="col-sm-2 control-label">Rue, numéro et l'étage</label>
              <div class="col-sm-offset-2 row ">
                <div class="col-xs-9">                
                  <input id="address-line1" ng-model="user.addresses[$index].streetAdress"  type="text" ng-blur="updateMap(user.addresses[$index],user)" placeholder="rue et numéro" class="form-control input-lg" require>
                </div>
                <div class="col-xs-2 nopadding">                
                  <input id="floor1" ng-model="user.addresses[$index].floor" type="text" placeholder="Étage" class="form-control input-lg" require>
                </div>

              </div>
            </div>

            <!-- POSTAL -->
            <div class="form-group  required">
              <label class="col-sm-2 control-label">Code Postal</label>
              <div class="col-sm-10">
                  <select class="form-control input-lg" ng-model="user.addresses[$index].postalCode"  
                           data-ng-options="l for l in config.shop.user.location.list" 
                           ng-change="updateMap(user.addresses[$index],user)">
                      <option value="">-- Choisissez  --</option>
                  </select>
              </div>
            </div>

            <!-- REGION -->
            <div class="form-group required">
              <label class="col-sm-2 control-label">Region</label>
              <div class="col-sm-10">
                  <select class="form-control input-lg" ng-model="user.addresses[$index].region"  
                           data-ng-options="l for l in config.shop.user.region.list" 
                           ng-change="updateMap(user.addresses[$index],user)">
                      <option value="">-- Choisissez  --</option>
                  </select>
              </div>
            </div>

            <!-- GEO MAP -->
            <div class="form-group" ng-show="user.addresses[$index].geo">
              <label  class="col-sm-2 control-label">Position sur la carte</label>
              <div class="col-sm-10">
                <img src="{{user.geo.resolveStaticmap(user.addresses[$index],user.addresses[$index].note)}}" style="width:100%"/>
              </div>
            </div>

            <!-- SELECT MAIN ADDRESS -->
            <div class="form-group">
              <label  class="col-sm-2 control-label">Pricinpale</label>
              <div class="col-sm-10">
                <label class="form-control-static"><input class=""  type="checkbox"   ng-model="user.addresses[$index].primary" _disabled="user.hasPrimaryAddress()!=$index">&nbsp;Adresse principale de livraison</label>
              </div>
            </div>
          </div>
          </div>          
          
          <!--     -->
          <!-- MAP -->
          <!--     -->
  <!--             <leaflet center="geneva" legend="legend" event-broadcast="events" 
            defaults="defaults" markers="markers" style="height: 250px; width: 80%">
          </leaflet>        
  -->

          <div class="form-group bottom">
            <input type="submit" ng-click="save(user)" 
                   ng-disabled="form.$invalid || WaitText" 
                   value="{{WaitText || 'Enregistrer'}}" 
                   ga-send="{category:'account',action:'update'}" 
                   class="col-sm-offset btn btn-success btn-lg"/>
            <button class="btn btn-lg pull-right"
                    ng-class="{'btn-warning':!user.addresses.length,'btn-default':user.addresses.length,}" 
                    ng-click="user.addresses.push({primary:true})">
              Ajouter une addresse de livraison 
            </button> 
          </div>          
      </form>      




      <!-- FOOTER -->              
        <footer class="wrapper-footer" ng-include="'/footer.html'"></footer>

      </section>
   </section>
</div>


